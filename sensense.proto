syntax = "proto3";
option go_package = ".;proto";

message MatchRequest {
  string player_id = 1;
  string game = 2;
  int32 player_limit = 3;
  string code = 4;
}

message MatchEvent {
  enum Type {
    UPDATED = 0;
    COMPLETED = 1;
  }
  Type type = 1;
  string code = 2;
  int32 player_index = 3;
  int32 player_count = 4;
  string game_id = 5;
  
}

message EndLevelRequest {
  string level_id = 1;
}

service MatchService {
  rpc Match(MatchRequest) returns (stream MatchEvent) {};
}

message CreateGameRequest {
  repeated string player_id = 1;
}

message CreateGameResponse {
  string game_id = 1;
}

message GameEvent {
  enum Type {
    DATA_NONE = 0;
    DATA_INT = 1;
    DATA_STRING = 2;
    DATA_MAP = 3;
    DATA_BYTES = 4;
    DATA_MIXED = 5;
  }
  string game_id = 1;
  string player_id = 2;
  Type type = 3;
  string key = 4;
  int32 value_int = 5;
  string value_string = 6;
  map<string, string> value_map = 7;
  bytes value_bytes = 8;
}

service GameService {
  rpc Create(CreateGameRequest) returns (CreateGameResponse) {};
  rpc Play(stream GameEvent) returns (stream GameEvent) {};
}